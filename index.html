<!DOCTYPE html>
<html>
<body onload="getE_URL(2000,03,14)">

<h2>The Economist Audio Lis</h2>



<p>URL:</p>

<p id="list"></p>

<script>

var url2021="http://audiocdn.economist.com/sites/default/files/AudioArchive/2021/20210102/Issue_9226_20210102_The_Economist_Full_edition.zip";

var url2012="http://audiocdn.economist.com/sites/default/files/AudioArchive/2012/20120414/20120414_TheEconomist_Full_Edition.zip";


var cdnurl = "http://audiocdn.economist.com/sites/default/files/AudioArchive/";

var fileurl = "The_Economist_Full_edition.zip";

var urlstr = cdnurl + "{0}/{1}/Issue_{2}_{1}_" + fileurl;

var urlstr_2012 = cdnurl + "{0}/{1}/{1}_TheEconomist_Full_Edition.zip";

/*
8796
2012-08-04

*/

var InitiaYear = 2021;
var InitialDate = new Date(InitiaYear,0,2);
var InitiaIssue = 9226;


function getE_URL(year,month,day)
{
var d = new Date(year, month, day);

if (month == 11 && day >25) //Christmas
	d = new Date(year, month, day-7);

dayofweek = d.getDay();

//console.log(dayofweek);


if (dayofweek<6)
	d = new Date(year, month, day-1-dayofweek);



datestr=d.toISOString().slice(0, 10).replace(/-/g, '');
issuestr=Math.round(InitiaIssue - (year-InitiaYear) + (d-InitialDate)/(1000*60*60*24*7));


//console.log(issuestr);


String.prototype.format = function()
{
   var content = this;
   for (var i=0; i < arguments.length; i++)
   {
        var replacement = '{' + i + '}';
        content = content.replaceAll(replacement, arguments[i]);  
   }
   return content;
};



this.document.getElementById("list").innerHTML =  issuestr > 8796?

urlstr.format(year,datestr,issuestr):urlstr_2012.format(year,datestr,issuestr)





}



</script>

</body>
</html>
